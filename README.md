# FIAP - Faculdade de Inform√°tica e Administra√ß√£o Paulista

<p align="center">
<a href= "https://www.fiap.com.br/"><img src="assets/logo-fiap.png" alt="FIAP - Faculdade de Inform√°tica e Admnistra√ß√£o Paulista" border="0" width=40% height=40%></a>
</p>

<br>

# üå± Projeto de Previs√£o de Produtividade Agr√≠cola com Machine Learning

## Nome do projeto
Fase 6 - Enterprise Challenge - Sprint 2 - Ingredion

## Nome do grupo
Grupo 37

## üë®‚Äçüéì Integrantes: 
- [Ana Beatriz Duarte Domingues](https://www.linkedin.com/in/)
- [Junior Rodrigues da Silva](https://www.linkedin.com/in/jrsilva051/)
- [Carlos Emilio Castillo Estrada](https://www.linkedin.com/in/)

## üë©‚Äçüè´ Professores:
### Tutor(a)
- [Lucas Gomes Moreira](https://www.linkedin.com/company/inova-fusca)
### Coordenador(a)
- [Andr√© Godoi Chiovato](https://www.linkedin.com/company/inova-fusca)

---

## üìÅ Estrutura de pastas

Dentre os arquivos e pastas presentes na raiz do projeto, definem-se:

- <b>.github</b>: Nesta pasta ficar√£o os arquivos de configura√ß√£o espec√≠ficos do GitHub que ajudam a gerenciar e automatizar processos no reposit√≥rio.

- <b>assets</b>: aqui est√£o os arquivos relacionados a elementos n√£o-estruturados deste reposit√≥rio, como imagens.

- <b>config</b>: Posicione aqui arquivos de configura√ß√£o que s√£o usados para definir par√¢metros e ajustes do projeto.

- <b>document</b>: aqui est√£o todos os documentos do projeto que as atividades poder√£o pedir. Na subpasta "other", adicione documentos complementares e menos importantes.

- <b>scripts</b>: Posicione aqui scripts auxiliares para tarefas espec√≠ficas do seu projeto. 

- <b>src</b>: Todo o c√≥digo fonte criado para o desenvolvimento do projeto.

- <b>README.md</b>: arquivo que serve como guia e explica√ß√£o geral sobre o projeto.



## üìú Descri√ß√£o

Este projeto tem como objetivo desenvolver modelos de Intelig√™ncia Artificial capazes de prever a produtividade agr√≠cola (soja e milho) no Brasil, utilizando dados hist√≥ricos de safras e an√°lise explorat√≥ria. Faz parte da Sprint 2 o tratamento de dados, testes com diferentes algoritmos de machine learning e avalia√ß√£o de desempenho para apoiar a tomada de decis√£o no agroneg√≥cio.

## üîç 1. Prepara√ß√£o dos Dados

Os dados utilizados contemplam indicadores de **√°rea plantada**, **produtividade por hectare**, **produ√ß√£o total** e suas respectivas varia√ß√µes entre dois per√≠odos: 2023‚Äì2024 e 2024‚Äì2025. As colunas principais s√£o:

| Coluna | Descri√ß√£o |
|--------|-----------|
| `REGIAO` | Regi√£o do Brasil |
| `UF` | Estado |
| `CULTURA` | Soja ou Milho |
| `AREA_PERIODO_23_24` | √Årea plantada em mil hectares (2023‚Äì2024) |
| `AREA_PERIODO_24_25` | √Årea plantada em mil hectares (2024‚Äì2025) |
| `AREA_VAR` | Varia√ß√£o percentual da √°rea plantada |
| `PRODU_SAFRA_23_24` | Produtividade em kg/ha (2023‚Äì2024) |
| `PRODU_SAFRA_24_25` | Produtividade em kg/ha (2024‚Äì2025) |
| `PRODU_VAR` | Varia√ß√£o percentual da produtividade |
| `PRODUC_SAFRA_23_24` | Produ√ß√£o total em mil toneladas |
| `PRODUC_SAFRA_24_25` | Produ√ß√£o total em mil toneladas |
| `PRODUC_VAR` | Varia√ß√£o percentual da produ√ß√£o |

O processo de prepara√ß√£o dos dados incluiu:
- Padroniza√ß√£o de colunas e tipos de dados
- Convers√£o de categorias para vari√°veis num√©ricas (one-hot encoding)
- Normaliza√ß√£o de vari√°veis cont√≠nuas
- Separa√ß√£o por cultura e per√≠odo

<img src="assets/analise_estat.png" alt="An√°lise Estat√≠stica dos Dados" width="500px">

> *Figura 1 ‚Äì An√°lise estat√≠stica dos dados.*

---

## üìä 2. An√°lise Explorat√≥ria e Justificativa das Vari√°veis

### Soja:
A an√°lise visual sugere um aumento na produtividade da soja em 2024‚Äì2025, com mais √°reas na faixa de 3500‚Äì4000 kg/ha.

<img src="assets/hist_soja.png" alt="Distribui√ß√£o da produtividade da soja" width="500px">

> *Figura 2 ‚Äì Distribui√ß√£o da produtividade da soja nos per√≠odos 2023‚Äì2024 e 2024‚Äì2025.*

Apesar do aumento geral, houve persist√™ncia de regi√µes com baixa produtividade (< 500 kg/ha), indicando poss√≠veis fatores limitantes como solo ou clima.

### Milho:
No milho, observou-se maior dispers√£o nos dados de 2024‚Äì2025, com presen√ßa de produtividades tanto mais baixas quanto mais altas.

<img src="assets/hist_milho.png" alt="Distribui√ß√£o da produtividade do milho" width="500px">

> *Figura 3 ‚Äì Distribui√ß√£o da produtividade do milho nos per√≠odos 2023‚Äì2024 e 2024‚Äì2025.*

A faixa principal de 4500‚Äì6000 kg/ha permaneceu, mas surgiram extremos que indicam variabilidade clim√°tica ou de manejo.


‚úÖ **Vari√°veis escolhidas para modelagem**:
- `REGIAO`, `UF`, `CULTURA`
- `AREA_VAR`, `PRODU_VAR`, `PRODUC_VAR`
- Valores absolutos das safras 23/24 como base para previs√£o da 24/25

Essas vari√°veis foram escolhidas por apresentarem **forte correla√ß√£o com os resultados de produ√ß√£o futura**, al√©m de fornecerem uma representa√ß√£o completa do cen√°rio agr√≠cola em diferentes regi√µes.

---
Testamos tr√™s abordagens:

| Modelo              | Vantagens                                    | Desvantagens                               |
|---------------------|----------------------------------------------|--------------------------------------------|
| Regress√£o Linear    | Simples e interpret√°vel                      | Sujeita a underfitting                      |
| Random Forest       | Boa generaliza√ß√£o, robusto contra overfitting| Requer mais processamento                   |
| Gradient Boosting   | Alta precis√£o em treino e teste              | Risco de overfitting                        |

<img src="assets/avaliacao_modelos.png" alt="Avali√ß√£o do Desempenho dos Modelos usando Mean Squared Error e o R-squared" width="500px">

> *Figura 4 ‚Äì Avalia√ß√£o do desempenho dos modelos usando Mean Squared Error (MSE) e o R-squared (R¬≤).*

### üîß Ajuste de Hiperpar√¢metros e Otimiza√ß√£o do Desempenho
- Random Forest: `n_estimators=100`, `max_depth=None`
- T√©cnicas utilizadas: `GridSearchCV` e `RandomizedSearchCV`.

<img src="assets/hiperparametros.png" alt="Otimiza√ß√£o de Hiperpar√¢metros" width="500px">

> *Figura 5 ‚Äì Otimiza√ß√£o de Hiperpar√¢metros*

Os resultados da otimiza√ß√£o de hiperpar√¢metros para o modelo Random Forest para soja s√£o muito bons. Um R¬≤ de 0,95 sugere que o modelo √© capaz de explicar grande parte da variabilidade na produtividade da soja, e o MSE de aproximadamente 126533,84 indica que os erros de previs√£o, em m√©dia, n√£o s√£o excessivamente grandes no contexto da escala de produtividade (que provavelmente varia em milhares de kg/ha).
Os melhores hiperpar√¢metros encontrados sugerem que, para a soja, um modelo Random Forest com alta complexidade (sem restri√ß√£o de profundidade m√°xima) e um n√∫mero razo√°vel de √°rvores (100) funciona bem com os dados dispon√≠veis.

---

## üìã 3. Avalia√ß√£o Detalhada e Ajustes da Modelagem

### 3.1 Modelo de Regress√£o Linear Simples

Inicialmente, foi constru√≠do um modelo de regress√£o linear simples para prever a produ√ß√£o de 2024/2025 com base na produ√ß√£o de 2023/2024.

üîé Observa√ß√µes do gr√°fico:
- O gr√°fico mostra uma forte correla√ß√£o positiva entre a produ√ß√£o real e a produ√ß√£o predita.
- Os pontos est√£o relativamente pr√≥ximos de uma linha reta imagin√°ria, indicando que o modelo consegue prever a produ√ß√£o com boa precis√£o na maioria dos casos.
- O R¬≤ de 0.90 sugere que o modelo explica 90% da variabilidade na produ√ß√£o real.
- Apesar de alguns desvios, o modelo apresenta um bom ajuste aos dados.

<img src="assets/regressao_simples.png" alt="Gr√°fico Regress√£o Linear Simples" width="500px">

> *Figura 6 ‚Äì Previs√£o de produ√ß√£o 24/25 com base em 23/24 ‚Äì Regress√£o Linear Simples.*

---

### 3.2 Teste com Diferentes Divis√µes de Dados (Simulado)

Como o conjunto de dados possui apenas dois per√≠odos de tempo, simulamos diferentes divis√µes de dados para teste, variando a separa√ß√£o de treino e teste.

üîé Observa√ß√µes do gr√°fico:
- A correla√ß√£o entre a produ√ß√£o real e a prevista tornou-se fraca.
- Os pontos ficaram bastante dispersos.
- O R¬≤ caiu para 0.36, indicando que o modelo explica apenas 36% da variabilidade na produ√ß√£o real.
- O ajuste aos dados foi ruim, com grande diferen√ßa entre valores reais e previstos.

<img src="assets/teste_simulado.png" alt="Gr√°fico Simula√ß√£o com Outra Divis√£o" width="500px">

> *Figura 7 ‚Äì Teste do modelo com outra divis√£o de dados.*

---

### 3.3 Ajuste da Estrat√©gia de Modelagem (Adi√ß√£o de Novas Caracter√≠sticas)

Buscando melhorar a precis√£o, adicionamos novas vari√°veis ao modelo, como:
- √Årea cultivada
- Produtividade do ano anterior

üîé Observa√ß√µes dos resultados e gr√°fico:
- Mesmo com mais caracter√≠sticas, o modelo avan√ßado apresentou desempenho fraco.
- MSE e RMSE permaneceram altos.
- O R¬≤ continuou baixo em 0.36.
- O gr√°fico de res√≠duos mostrou grande dispers√£o, indicando erros significativos e imprecis√£o nas previs√µes.

<img src="assets/ajuste_avancado.png" alt="Gr√°fico Ajuste Avan√ßado" width="500px">

> *Figura 8 ‚Äì Resultados ap√≥s adi√ß√£o de vari√°veis ao modelo.*

<img src="assets/dist_residuos.png" alt="Gr√°fico Distribui√ß√£o de Res√≠duos" width="500px">

>*Figura 9 ‚Äì Distribui√ß√£o dos res√≠duos do modelo avan√ßado.*
 
---

‚úÖ Esses testes mostram que, embora o modelo inicial tivesse bom desempenho com divis√£o padr√£o, seu comportamento se deteriora com outras divis√µes e ajustes. Assim, √© recomendado utilizar abordagens mais robustas (como Random Forest ou Gradient Boosting) para futuras previs√µes.

---

## üìà 4. Avalia√ß√£o e Resultados

### Resultados ‚Äì Soja

| Modelo            | R¬≤     | MSE        |
|-------------------|--------|------------|
| Regress√£o Linear  | 1.00   | 250.70     |
| Random Forest     | 0.95   | 126533.84  |
| Gradient Boosting | 1.00   | 1403.43    |

- A Regress√£o Linear teve um erro muito baixo (MSE de 250.70) e acertou 100% da varia√ß√£o nos dados que usamos para teste (R¬≤ de 1.00).
- O Random Forest errou um pouco mais (MSE de 126533.84), mas ainda explicou 95% da varia√ß√£o (R¬≤ de 0.95).
- O Gradient Boosting tamb√©m pareceu perfeito nos testes, com um erro baixo (MSE de 1403.43) e explicando 100% da varia√ß√£o (R¬≤ de 1.00).
Esses resultados perfeitos (R¬≤ de 1.00) para a Regress√£o Linear e o Gradient Boosting nos deixam alertas para uma poss√≠vel memoriza√ß√£o sem compreens√£o dos dados de teste, o que pode significar que eles n√£o seriam t√£o bons em prever a produ√ß√£o de soja em situa√ß√µes novas. O Random Forest, apesar de errar um pouco mais nos testes, pode ser mais confi√°vel para previs√µes futuras.


---

### Resultados ‚Äì Milho

| Modelo            | R¬≤     | MSE        |
|-------------------|--------|------------|
| Regress√£o Linear  | 0.88   | 408753.28  |
| Random Forest     | 0.91   | 312554.16  |
| Gradient Boosting | 0.92   | 275282.05  |

- A Regress√£o Linear teve um erro grande (MSE de 408753.28) e explicou 88% da varia√ß√£o (R¬≤ de 0.88).
- O Random Forest se saiu melhor, com um erro menor (MSE de 312554.16) e explicando 91% da varia√ß√£o (R¬≤ de 0.91).
- O Gradient Boosting foi o melhor, com o menor erro (MSE de 275282.05) e explicando 92% da varia√ß√£o (R¬≤ de 0.92).
Para o milho, o Gradient Boosting foi o m√©todo mais preciso, seguido pelo Random Forest, mostrando que m√©todos mais complexos funcionam melhor que uma simples linha reta (Regress√£o Linear).

---

### Resultados ‚Äì Brasil (Todos os Dados)

| Modelo            | R¬≤     | MSE        |
|-------------------|--------|------------|
| Regress√£o Linear  | 0.94   | 215477.66  |
| Random Forest     | 0.97   | 110145.04  |
| Gradient Boosting | 0.97   | 103784.57  |

- A Regress√£o Linear teve um erro de 215477.66 e explicou 94% da varia√ß√£o (R¬≤ de 0.94).
- O Random Forest reduziu o erro para 110145.04 e explicou 97% da varia√ß√£o (R¬≤ de 0.97).
- O Gradient Boosting teve o menor erro (103784.57) e tamb√©m explicou 97% da varia√ß√£o (R¬≤ de 0.97).
Para a produ√ß√£o total do Brasil, tanto o Random Forest quanto o Gradient Boosting foram muito bons, explicando quase toda a varia√ß√£o nos dados. O Gradient Boosting teve um erro ligeiramente menor.

---

## ‚ñ∂Ô∏è 5. Demonstra√ß√£o em V√≠deo

üé• [Clique aqui para assistir √† demonstra√ß√£o no YouTube](https://youtu.be/KSfXhDJwzbc)

---

## ‚öôÔ∏è 6. Como Executar o Projeto

```bash
# Instalar depend√™ncias
pip install -r config/requirements.txt

# Executar o pr√©-processamento
python scripts/pre_processamento.py

# Treinar o modelo
python scripts/treina_modelo.py
```

## üìö Hist√≥rico de Lan√ßamentos

* 0.1.0 - 24/04/2025
    * Primeira vers√£o do projeto com an√°lise explorat√≥ria, clusteriza√ß√£o e modelos de regress√£o.

---

## üìã Licen√ßa

<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://github.com/agodoi/template">MODELO GIT FIAP</a> por <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://fiap.com.br">Fiap</a> est√° licenciado sobre <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">Attribution 4.0 International</a>.</p>
